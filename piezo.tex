%% ****** Start of file rsitemplate.tex ****** %
%%
%%   This file has been edited from the original source file.
%%	 The original file is part of the revtex4-1 package indicated below.
%%   Version 4.1 of 9 October 2009.
%%
%
% This is a template for producing documents for use with 
% the REVTEX 4.1 document class and the RSI substyle.
% 
% Copy this file to another name and then work on that file.
% That way, you always have this original template file to use.
\documentclass[aip,rsi,reprint]{revtex4-1} % for checking your page length
%\documentclass[aip,rsi,reprint,graphicx,draft]{revtex4-1} % for checking your page length
%\\documentclass[aip,rsi,preprint,graphicx]{revtex4-1} % for review purposes

\usepackage{siunitx}
\usepackage{amsmath}
\usepackage{amsfonts}

\usepackage{graphicx}
%\usepackage{caption}
%\usepackage{subcaption}

%% Work with illustrator *.ai files...
\DeclareGraphicsRule{.ai}{pdf}{.ai}{}

\begin{document}

% Use the \preprint command to place your local institutional report number 
% on the title page in preprint mode.
% Multiple \preprint commands are allowed.
%\preprint{}

\title{An ultra-low noise, high-voltage piezo driver}

% repeat the \author .. \affiliation  etc. as needed
% \email, \thanks, \homepage, \altaffiliation all apply to the current author.
% Explanatory text should go in the []'s, 
% actual e-mail address or url should go in the {}'s for \email and \homepage.
% Please use the appropriate macro for the type of information

% \affiliation command applies to all authors since the last \affiliation command. 
% The \affiliation command should follow the other information.

\author{N.C. Pisenti}
\email[]{npisenti@umd.edu}
\author{B.J. Reschovsky}
\author{D.S. Barker}
\author{A. Restelli}
\author{G.K. Campbell}
%\homepage[]{Your web page}
%\thanks{}
%\altaffiliation{}
\affiliation{Joint Quantum Institute, University of Maryland and National Institute of Standards and Technology}

% Collaboration name, if desired (requires use of superscriptaddress option in \documentclass). 
% \noaffiliation is required (may also be used with the \author command).
%\collaboration{}
%\noaffiliation

\date{\today}

\begin{abstract}
We present an ultra-low noise, high voltage driver suited for use with piezoelectric actuators and other low-current applications.
The architecture leverages a commercially available, small-form-factor integrated circuit (IC) for generating high voltage outputs.
The IC uses a flyback configuration switching regulator to generate up to 250V in our design (but up to 1kV or more with small modification), and a high slew-rate op-amp capacitively coupled to the output compensates for the switching noise.
A low-voltage (\SI{\pm 10}{\volt}), high bandwidth modulation input is capable of summing small voltage corrections onto the output, making the driver well suited for use in closed-loop feedback applications.
\end{abstract}

\pacs{}% insert suggested PACS numbers in braces on next line

\maketitle %\maketitle must follow title, authors, abstract and \pacs

% Body of paper goes here. Use proper sectioning commands. 
% References should be done using the \cite and \label commands
\section{Introduction}
\label{Sec:Introduction}

Many instrumentation applications in the modern laboratory require agile, low-noise voltage sources that can supply hundreds of volts or more.
Such high-voltage amplifiers are useful for micro-positioning applications, driving piezo-actuated mirrors (e.g., in a scanning Fabry-Per{\`o}t cavity) or diffraction gratings (such as in extended-cavity diode lasers).
Precision high voltage sources can also be used to bias low-noise, high-bandwidth photodiodes [details?], Other applications...? biophysics? medical devices?
Often, these applications are operated in a closed feedback loop, where small voltage changes on top of a large DC voltage are necessary to correct for some disturbance to the system.

Traditionally, laboratory electronics capable of supplying high voltages fall under one of two architectural umbrellas: switching converters, and ``linear'' amplifiers.
DC-DC converters are efficient and can work at very high voltages, but suffer from switching noise and limited control bandwidths.
Linear-type devices are typically constructed from a high-voltage operational amplifier (op-amp), powered either from a high voltage linear regulator or more typically from a secondary switching converter.
While the op-amp provides \SI{100}{\decibel} or more of power-supply noise rejection, a high-voltage op-amp require substantially more power than an equivalent switching circuit.
In either case, the output voltage  $V_{\text{out}}$ is typically given by
\begin{align}
  V_{\text{out}} &= G_p(V_{\text{DC}} + V_{\text{mod}})\, \text{,}
\end{align}
where $G_p$ is the piezo amplifier gain (typically {$G_p\approx \num{10} - \num{20}$} or more), $V_{\text{DC}}$ is a DC setpoint, and $V_{\text{mod}}$ is a modulation input used for closed-loop control.

It is often the case, however, that in closed-loop feedback applications we do not need and often do not want the modulation control to have a high gain.
Because the closed loop gain cannot be increased without limit, $G_p V_{\text{mod}} \gg 1$ means the servo gain $G$ must be proportionally smaller to keep the lock stable.
Because noise added by the servo is suppressed by $1/|G|$ in the large gain limit, if $G$ is limited to achieve a stable lock it is no longer as effective at servoing its own noise.

To avoid this problem, we desire a high voltage amplifier which separates the ``setpoint'' gain $G_p$ from the modulation gain, $G_m$. That is,
\begin{align}
  V_{\text{out}} &= G_p V_{\text{DC}} + G_m V_{\text{mod}}\, \text{,}
  \label{Eq:PiezoTransfer}
\end{align}
where now we can make $G_m \approx 1$.

\section{Circuit Design}
\label{Sec:Circuit}

The design is based on the newly-available Texas Instruments DRV2700 piezo driver.
\footnote{The identification of commercial products is for information only and does not imply recommendation or endorsement by the National Institute of Standards and Technology.}
This single-chip integrated circuit (IC) can be operated as a boost converter to drive an on-chip differential amplifier up to \SI{100}{\volt}, or as a flyback converter up to \SI{1}{\kilo\volt}.
In flyback configuration, the internal-boost switch of the DRV2700 drives a step-up transformer.
When the switch is closed, current flows through the primary coil of the transformer and induces a corresponding voltage across the secondary coil, which charges a capacitor at the output ($\text{C}_{\text{HV}}$ in Fig.~\ref{Fig:PiezoCircuit}).
When the switch opens, a negative voltage appears across the secondary coil of the transformer, but a diode prevents the capacitor from discharging.
One key benefit of this topology is the galvanically isolated output.
By sensing the output voltage across a resistive divider, we servo the floating ground from the flyback converter to remove switching noise and stabilize the high voltage output; see Fig.~\ref{Fig:PiezoCircuit}.

\begin{figure*}[t]
\includegraphics[width=\textwidth]{fig/DRV2700.ai}
\caption{Schematic of the high voltage stabilization.
The voltage HV is generated using a Texas Instruments DRV2700 high voltage driver in flyback configuration (see Fig.~\ref{Fig:DRV2700}).
A fast, very high slew-rate op-amp senses the output voltage across $R_1$ and $R_2$, and servos it by modulating the node at ``HV floating gnd''.
The $V_{\text{DC}}$ gain is set by $\left(1+R_1/R_2\right)$, while the modulation gain is set by $-R_{\text{mod}}/R_{\text{fb}}$.
The capacitor linking the floating ground node to the output allows the op-amp to remove residual switching noise and stabilize the DC output according to the transfer function given in Eq.~(\ref{Eq:PiezoTransfer}). \label{Fig:PiezoCircuit}}
\end{figure*}

In isolation, the DRV2700 is not suited for low-noise laboratory instrumentation. 
The output ripple, even after heavy filtering, can be as high as a few volts, and standard filtering techniques to reduce this noise simultaneously reduces the modulation control bandwidth.
Even if this were not the case, it remains unlikely that the RMS noise could be brought below $\SI{1}{\milli\volt}$, which is the operating regime we require for certain low-noise applications in the laboratory.
Despite this drawback, the flyback converter requires very little current to operate and leverages a compact IC to generate very high voltages, making it versatile and easy to deploy in the lab.

The motivation behind our hybrid architecture is twofold.
First, to make a switching converter useful for low-noise laboratory instrumentation, we need a way to remove the output ripple and residual switching noise.
Second, we want to take advantage of low-noise op-amps that only work up to tens of volts to provide a unity gain (DC-coupled) feedback path to the high voltage output.
The architecture shown in Fig.~\ref{Fig:PiezoCircuit} does just this; a low-noise, high-slew rate op-amp ($\mathbf{U2}$) adjusts the floating ground node of the transformer output to cancel switching noise and sum in an offset given by $V_{\text{mod}}$, while the flyback regulator works close to DC to impose the high voltage across the HV - floating ground output.
We now explain the operation of each sub-block, and draw attention to important design details.

\subsection{DRV2700 flyback regulator}
\label{Sec:DRV2700}

We based the flyback regulator design off the suggested schematic in the DRV2700 datasheet and evaluation module application note.
At a basic level, this requires a transformer (ATB3225; 1:10 step-up winding, \SI{7}{\micro\henry} inductance, rated for \SI{0.6}{\ampere}) connected to an output diode and capacitor, and a voltage supplied to the feedback (FB) node.
Internally, the DRV2700 boost controller tries to drive the FB node to \SI{1.3}{\volt}.
The op-amp U1 senses the voltage at node \textit{HV} and \textit{GND}${}_\text{HV}$, and adjusts its output such that
\begin{align}
\label{Eq:U1Output}
\text{HV} &= G\cdot V_{\text{dc}} + \text{GND}_{\text{HV}}\,,
\end{align}
where the gain $G$ is set by the resistor ratio $R_3/R_4$.
The capacitors $C_3$ and $C_4$ are chosen such that $C_3 = \SI{22}{\pico\farad}$ and 
\begin{align}
\frac{C_4}{C_3} &= \frac{R_3}{R_4~||~R_5}
\end{align}
as suggested by the datasheet.
This pseudo-differential configuration ensures that, in the equilibrium given by Eq.~(\ref{Eq:U1Output}), the output of U1 is driven to \SI{0}{\volt}; the resistive divider $R_9$ and $R_{10}$ is then chosen such that $R_9/(R_9~||~R_{10}) = \SI{1.3}{\volt}/\SI{5}{\volt} \approx \num{0.26}$.

Notes here about expected, measured bandwidth??

The DRV2700 IC, combined with the the feedback provided by U1, regulates the voltage $(\text{HV}-\text{GND}_{\text{HV}}) = G\cdot V_{\text{dc}}$.
Careful attention was paid to the layout ...

\subsection{Low-noise stabilization}
\label{Sec:LowNoiseStabilization}
%At high frequencies, this modulation appears directly at the HV node through the capacitors.
%At quasi-DC frequencies, the flyback regulator adjusts the HV node to keep 

The choice of component for resistors $R_1$ and $R_2$ is crucial for the low-noise performance of the system. (cite LIGO paper)

\subsection{Digital control and auxiliary design features}
\label{Sec:DigControlAuxDesign}

\section{Results}
\label{Sec:Results}
Noise analysis, bandwidth, (DC) stability, etc.


\section{Conclusion}
\label{Sec:Conclusion}


% If in two-column mode, this environment will change to single-column format so that long equations can be displayed. 
% Use only when necessary.
%\begin{widetext}
%$$\mbox{put long equation here}$$
%\end{widetext}

% Figures should be put into the text as floats. 
% Use the graphics or graphicx packages (distributed with LaTeX2e). EPSFig is no longer fully supported.
% See the LaTeX Graphics Companion by Michel Goosens, Sebastian Rahtz, and Frank Mittelbach for examples. 
%
% Here is an example of the general form of a figure:
% Fill in the caption in the braces of the \caption{} command. 
% Put the label that you will use with \ref{} command in the braces of the \label{} command.
%
% \begin{figure}
% \includegraphics{}% % Important NOTE: Please make certain your figures do not include local directory paths. ex. "c:\file\sub\fig1.eps"
% \caption{\label{}}%
% \end{figure}

% Tables may be be put in the text as floats.
% Here is an example of the general form of a table:
% Fill in the caption in the braces of the \caption{} command. Put the label
% that you will use with \ref{} command in the braces of the \label{} command.
% Insert the column specifiers (l, r, c, d, etc.) in the empty braces of the
% \begin{tabular}{} command.
%
% \begin{table}
% \caption{\label{} }
% \begin{tabular}{}
% \end{tabular}
% \end{table}

% If you have acknowledgments, this puts in the proper section head.
%\begin{acknowledgments}
% Put your acknowledgments here.
%\end{acknowledgments}

% Create the reference section using BibTeX:
%\bibliography{your-bib-file}
% Run this once to generate your BBL file. Then copy the contents of your BBL file into your main latex file, commenting out "\bibliography"

\end{document}
%
% ****** End of file aiptemplate.tex ******
